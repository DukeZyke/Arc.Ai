{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saved</title>
    <link rel="stylesheet" href="{% static 'styles/styles.css' %}?v=1.0">
    <link rel="stylesheet" href="{% static 'styles/saved.css' %}?v=1.0">
</head>
<body>
    <div id="sidebar">
        <div id="sidebar_icns_grp">
            <img class="sidebar_icns" src="{% static 'Images/Navigation.png' %}" alt="Navigate">
            <img class="sidebar_icns" src="{% static 'Images/Notification.png' %}" alt="Notification">
            <img class="sidebar_icns" src="{% static 'Images/Settings.png' %}" alt="Settings">
        </div>
    </div>
    <div id="header">
        <div>
            <img id="logo" src="{% static 'Images/Logo.png' %}" alt="ARC.AI Logo">
        </div>
        <div id="header_nav" class="text_white">
            <p><a href="{% url 'core:home' %}" class="{% if active_page == 'home' %}active{% endif %}">Home</a></p>
            <p><a href="{% url 'core:organization' %}" class="{% if active_page == 'organization' %}active{% endif %}">Organization</a></p>
            <p><a href="{% url 'core:saved' %}" class="{% if active_page == 'saved' %}active{% endif %}">Saved</a></p>
            <p><a href="{% url 'core:email' %}" class="{% if active_page == 'email' %}active{% endif %}">Email</a></p>
        </div>
        <div>
            <img id="account_icn" src="{% static 'Images/Account.png' %}" alt="Account">
        </div>
    </div>
    <div id="content">
        <h1>Folders</h1>
        <div id="folder_items">
        {% for folder in folders %}
            <p class="folders">{{ folder }}</p>
        {% endfor %}
        </div>
        
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <h1 class="titles">Files</h1>
            
            <!-- Horizontal Line Between Folders and Dropdown -->
            <div class="horizontal-line"></div>
            
            <!-- Dropdown Button -->
            <img src="{% static 'Images/dots.png' %}" alt="Dropdown Icon" class="dropdown-icon" onclick="toggleDropdown()" style="width: 40px; height: 40px; cursor: pointer;">
            <div class="dropdown-content" id="myDropdown">
                <a href="{% url 'core:google_drive_auth' %}">AUTHORIZE</a>
                <hr class="dropdown-divider">
        
                <!-- File Upload -->
                <form action="{% url 'core:upload_file_to_drive' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="file" name="file" multiple required>
                    <button type="submit">Upload</button>
                </form>
                
            </div>
        </div>

        <ul>
        {% for file in files %}
            <li>
            <a href="https://drive.google.com/file/d/{{ file.file_id }}/view" target="_blank">
                {{ file.name }}
            </a>
            </li>
        {% empty %}
            <li>No files uploaded yet.</li>
        {% endfor %}
        </ul>

        <h3>Trash</h3>
        <div id="file_items">
        {% for trash_file in trash %}
            <p class="file">{{ trash_file }}</p>
            <hr class="long-line">
        {% endfor %}
        </div>
    </div>
</body>

<script>
    function toggleDropdown() {
        document.getElementById("myDropdown").classList.toggle("show");
    }
    
    // Optional: Close the dropdown if clicking outside
    window.onclick = function(event) {
        // Check if click was NOT on the image
        if (!event.target.classList.contains('dropdown-icon')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            for (var i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }
    </script>
    
</html>