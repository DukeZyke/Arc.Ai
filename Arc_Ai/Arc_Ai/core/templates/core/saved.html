{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saved</title>
    <link rel="stylesheet" href="{% static 'styles/styles.css' %}?v=1.0">
    <link rel="stylesheet" href="{% static 'styles/saved.css' %}?v=1.0">
</head>
<body>
    <div id="header">
        <img src="{% static 'Images/Account.png' %}" alt="Account">
    </div>
    <div id="sidebar">
        <div id="logo">
            <img src="{% static 'Images/Logo_LandingPage.png' %}" alt="ARC.AI Logo">
            <hr>
        </div>
        <div id="upload">
            <img src="{% static 'Images/PlusIcon.png' %}" alt="ARC.AI Logo">
            <h1>Upload</h1>
        </div>
        <div id="sidebar_cont">
            <div id="navigate">
                <h1>Navigate</h1>
                <a href="#sec4" class="{% if active_page == 'home' %}active{% endif %}">Home</a>
                <a href="{% url 'core:organization' %}" class="{% if active_page == 'organization' %}active{% endif %}">Organization</a>
                <a href="{% url 'core:saved' %}" class="{% if active_page == 'saved' %}active{% endif %}">Files</a>
            </div>
            <div id="settings">
                <h1>Settings</h1>
                <a href="#sec4" class="{% if active_page == 'home' %}active{% endif %}">Profile</a>
                <a href="#sec4" class="{% if active_page == 'home' %}active{% endif %}">Notification</a>
            </div>
        </div>
        <div id="logout">
            <img src="{% static 'Images/Logout.png' %}" alt="">
            <h1>Logout</h1>
        </div>
    </div>
    
    <div id="content">
        <h1>Folders</h1>
        <div id="folder_items">
        {% for folder in folders %}
            <p class="folders">{{ folder }}</p>
        {% endfor %}
        </div>
        
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <h1 class="titles">Files</h1>
            
            <!-- Horizontal Line Between Folders and Dropdown -->
            <div class="horizontal-line"></div>
            
                <!-- {% for message in messages %}
                <h3 style="color: red;">message</h3>
                {% endfor %} -->

            <!-- Dropdown Button -->
            <img src="{% static 'Images/dots.png' %}" alt="Dropdown Icon" class="dropdown-icon" onclick="toggleDropdown()" style="width: 40px; height: 40px; cursor: pointer;">
            <div class="dropdown-content" id="myDropdown">
                <!-- File Upload -->
                <form action="{% url 'core:upload_file_to_drive' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="file" name="file" multiple required>
                    <button type="submit">Upload</button>
                </form>
                <hr class="dropdown-divider">

                <!-- DELETE Button -->
                <a href="#" onclick="toggleCheckboxes()">DELETE</a>
            </div>
        </div>

        <ul class="file-list">
            <div class="horizontal-line"></div>
            {% for file in files %}
                <li class="file-item">
                    <div class="file-icon">
                        <img src="{% static 'Images/file-icon.png' %}" alt="File Icon">
                    </div>
                    <div class="file-details">
                        <p class="file-name"><a href="https://drive.google.com/file/d/{{ file.file_id }}/view" target="_blank">{{ file.name }}</a></p>
                        <p class="file-owner">{{ file.owner }}</p>
                    </div>
                    <div class="file-meta">
                        <p>{{ file.date }}</p>
                        <p>{{ file.size }}</p>
                    </div>
                    <div class="file-actions">
                        <button class="action-button">â‹®</button>
                    </div>
                </li>
                <div class="horizontal-line"></div>
            {% empty %}
                <li>No files uploaded yet.</li>
            {% endfor %}
            
        </ul>


        <!-- Delete Selected Files Button -->
        <button id="delete-selected-btn" style="display: none;" onclick="deleteSelectedFiles()">Delete Selected Files</button>

        <h3>Trash</h3>
        <div id="file_items">
        {% for trash_file in trash %}
            <p class="file">{{ trash_file }}</p>
            <hr class="long-line">
        {% endfor %}
        </div>
    </div>
    <script src="{% static 'js/sidebar.js' %}"></script>
</body>

<script>
    function toggleDropdown() {
        document.getElementById("myDropdown").classList.toggle("show");
    }
    
    // Optional: Close the dropdown if clicking outside
    window.onclick = function(event) {
        // Check if click was NOT on the image
        if (!event.target.classList.contains('dropdown-icon')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            for (var i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }
    </script>
    <script src="{% static 'js/saved.js' %}"></script>
</html>