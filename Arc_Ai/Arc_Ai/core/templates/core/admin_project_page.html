{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin-Project Page</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'styles/adminstyles.css' %}">
    <link rel="stylesheet" href="{% static 'styles/adprojpage.css' %}">
</head>
<body>

<div id="sidebar">
    <div id="sidebar_content" class="hidden">
        <p><a href="{% url 'core:profilepage' %}">Users</a></p>
        <p><a href="{% url 'core:home' %}">Projects</a></p>
        <p><a href="{% url 'core:organization' %}">Files</a></p>
    </div>
    <hr class="divider_sidebar"/>

    <div class="notification_container">
    <!-- Notification Pop-Up -->
    <div id="notification_popup" class="hidden">
        <h2>Notifications</h2><button id="close_notification_popup" class="close-btn">&times;</button>
        <div id="notification_list">
            <ul>
                <li class="notification_item" data-detail="General meeting at 10:30 AM on January 3, 2024, will be held in the main conference room. All employees are expected to attend this important session where key company updates and strategic initiatives for the upcoming year will be discussed.">
                    <div class="title-and-date">
                        <p>Schedule Update</p>
                        <span>Yesterday</span>
                    </div>
                    <p class="short-description">General meeting at 10:30AM on Jan 3, 202 General meeting at 10:30AM on Jan 3, 2023</p>
                    <p class="posted-by">- Imee Duterte</p>
                </li>
            </ul>
        </div>
    </div>
    <!-- Detailed Notification -->
    <div id="detailed_notification" class="hidden">
        <h2 id="notification_title">Schedule Update</h2>
        <p class="notification_date">Yesterday, January 29, 2025</p>
        <button id="close_detailed_notification" class="close-btn">&times;</button>
        <p id="notification_detail"></p>
        <p class="posted-by">- Imee Duterte, Team Head</p>
        <button class="respond-btn">Respond</button>
    </div>
    </div>

    <div id="sidebar_icns_grp">
        <div class="nav_item">
            <img id="nav_icon" class="sidebar_icns" style="margin-bottom: -6px;" src="{% static 'Images/Navigation.png' %}" alt="Navigate">
            <p id="navigation_paragraph">Navigate</p>
        </div>
    </div>
</div>

    <div id="header">
        <div>
            <img id="logo" src="{% static 'Images/Logo.png' %}" alt="ARC.AI Logo">
        </div>
        <div id="header_nav" class="text_white">
            <p><a href="{% url 'core:home' %}" class="{% if active_page == 'home' %}active{% endif %}">Users</a></p>
            <p><a href="{% url 'core:organization' %}" class="{% if active_page == 'organization' %}active{% endif %}">Projects</a></p>
            <p><a href="{% url 'core:admin_files_page' %}" class="{% if active_page == 'saved' %}active{% endif %}">Files</a></p>
        </div>
        <div>
            <button class="logout">Log out</button>
        </div>
    </div>

<div id="project-management">
    <div class="project-management-header">
        <h1>Project Management</h1>
        <div class="search-bar">
            <input type="text" placeholder="Search Projects..." id="search-projects">
                <button id="search-button" class="search-icon-btn">
                    <i class="bx bx-search"></i>
                </button>
        </div>
        <div class="project-count">
            <span>Total Projects: <strong>69</strong></span>
            <span class="status-indicator"></span>
        </div>
        <div class="search-results-count">
            <span>Search Results: </span>
            <strong id="search-count">0</strong>
            <span class="search-indicator"></span>
        </div>
    </div>

    <div class="project-list">
        {% for project in projects %}
            <!-- Project Card -->
            <div class="project-card">
                <div class="project-icon">
                    <img src="{% static 'Images/project-icon.png' %}" alt="Project Icon">
                </div>
                <div class="project-info">
                    <h3>{{ project.name }}</h3>
                    <p>Project ID: HR-2024-ONB-{{ project.project_id }}</p>
                    <p>Start Date: {{ project.start_date }}</p>
                    <p>Finish Date: {{ project.finish_date }}</p>
                </div>

                <div class="project-meta">
                    <p><span class="span">Project Manager: </span> {{ project.project_manager }}</p>
                    <p> <span class="span">Project Team: </span>
                        
                        {% with total=project.members.count %}
                            {% for member in project.members.all %}
                                {% if forloop.counter <= 5 %}
                                    {{ member.member_name }}{% if forloop.counter < 5 and forloop.counter < total %}, {% endif %}
                                {% elif forloop.counter == 6 %}
                                    and {{ total|add:"-5" }} others
                                {% endif %}
                            {% empty %}
                                No members assigned.
                            {% endfor %}
                        {% endwith %}
                    </p>
                    {% if project.project_status == 'Complete' %}
                        <p class="status" >Status: <span class="status-ongoing" style="color: #6AFF3C">{{ project.project_status }}</span></p>
                    {% elif project.project_status == 'Ongoing' %}
                        <p class="status" >Status: <span class="status-ongoing" style="color: orange">{{ project.project_status }}</span></p>
                    {% elif project.project_status == 'Missing' %}
                        <p class="status" >Status: <span class="status-ongoing" style="color: red">{{ project.project_status }}</span></p>
                    {% endif %}
                </div>
                <div class="project-actions">
                    <a href="{% url 'core:admin_edit_project_details' project.id %}" class="edit-btn">
                        <img src="{% static 'Images/edit-icon.png' %}" alt="Edit">
                    </a>

                    <form action="{% url 'core:delete_project' project.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this project?');">
                        <img src="{% static 'Images/delete-icon.png' %}" alt="Delete">
                    </button>
                </form>
                
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <script src="{% static 'js/sidebar.js' %}"></script>
    <script src="{% static 'js/adprojpage.js' %}"></script>
</body>
</html>
