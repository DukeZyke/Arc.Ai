{% load static%}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin-File Page</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'styles/admin_files_page.css' %}">
    <link rel="stylesheet" href="{% static 'styles/adminstyles.css' %}">
    
</head>
<body>
    <div id="sidebar">
    <div id="sidebar_content" class="hidden">
        <p><a href="{% url 'core:profilepage' %}">Users</a></p>
        <p><a href="{% url 'core:home' %}">Projects</a></p>
        <p><a href="{% url 'core:organization' %}">Files</a></p>
    </div>
    <hr class="divider_sidebar"/>

    <div class="notification_container">
    <!-- Notification Pop-Up -->
    <div id="notification_popup" class="hidden">
        <h2>Notifications</h2><button id="close_notification_popup" class="close-btn">&times;</button>
        <div id="notification_list">
            <ul>
                <li class="notification_item" data-detail="General meeting at 10:30 AM on January 3, 2024, will be held in the main conference room. All employees are expected to attend this important session where key company updates and strategic initiatives for the upcoming year will be discussed.">
                    <div class="title-and-date">
                        <p>Schedule Update</p>
                        <span>Yesterday</span>
                    </div>
                    <p class="short-description">General meeting at 10:30AM on Jan 3, 202 General meeting at 10:30AM on Jan 3, 202</p>
                    <p class="posted-by">- Imee Duterte</p>
                </li>
            </ul>
        </div>
    </div>
    <!-- Detailed Notification -->
    <div id="detailed_notification" class="hidden">
        <h2 id="notification_title">Schedule Update</h2>
        <p class="notification_date">Yesterday, January 29, 2025</p>
        <button id="close_detailed_notification" class="close-btn">&times;</button>
        <p id="notification_detail"></p>
        <p class="posted-by">- Imee Duterte, Team Head</p>
        <button class="respond-btn">Respond</button>
    </div>
    </div>

    <div id="sidebar_icns_grp">
        <div class="nav_item">
            <img id="nav_icon" class="sidebar_icns" style="margin-bottom: -6px;" src="{% static 'Images/Navigation.png' %}" alt="Navigate">
            <p id="navigation_paragraph">Navigate</p>
        </div>
    </div>
</div>

    <div id="header">
        <div>
            <img id="logo" src="{% static 'Images/Logo.png' %}" alt="ARC.AI Logo">
        </div>
    <div id="header_nav" class="text_white">
        <p><a href="{% url 'core:admin_users_page' %}" class="{% if active_page == 'home' %}active{% endif %}">Users</a></p>
        <p><a href="{% url 'core:organization' %}" class="{% if active_page == 'organization' %}active{% endif %}">Projects</a></p>
        <p><a href="{% url 'core:admin_files_page' %}" class="{% if active_page == 'saved' %}active{% endif %}">Files</a></p>
    </div>
        <div>
            <button class="logout">Log out</button>
        </div>
    </div>

    <div id="file-management">
    <div class="file-management-header">
        <h1>File Manager</h1>
        <div class="search-bar">
            <input type="text" placeholder="Search Users..." id="search-users">
                <button id="search-button" class="search-icon-btn">
                    <i class="bx bx-search"></i>
                </button>
        </div>
        <div class="files-count">
            <span>Total Files: <strong>{{ total_files }}</strong></span>
            <span class="status-indicator"></span>
        </div>
        <div class="Used-Space">
            <span>Used Space: </span>
            <strong id="Total-space">{{ total_size }}</strong>
            <span class="space-indicator"></span>
        </div>
    </div>
    
    <!-- User sections - loop through all users -->
    {% for user_data in users_data %}
    <div class="card-container">
        <div class="avatar">
            <img src="{% static user_data.user.avatar %}" alt="User Avatar">
        </div>
        <div class="user-details">
            <div class="user-name">{{ user_data.user.name }}</div>
            <div class="user-email">({{ user_data.user.email }})</div>
        </div>
        <div class="job-info">
            <div class="department">Department: {{ user_data.user.department }}</div>
            <div class="position">Position: {{ user_data.user.position }}</div>
        </div>
        <div class="file-info">
            <div class="files">Total Files: {{ user_data.file_count }}</div>
            <div class="Folders">Total Folders: {{ user_data.folder_count }}</div>
        </div>
        <div class="icon-placeholder">
            <button class="icon-button dropdown-toggle">
                <i class="bx bx-caret-down"></i>
            </button>
        </div>

        <div class="content-box hidden">
            <div class="section-titles">
                <div class="files">
                    <div class="title-files">Files</div>
                    {% if user_data.files %}
                        {% for file in user_data.files %}
                        <div class="file-item">
                            <img src="{% static 'Images/default.png' %}" alt="File Icon" />
                            <div class="name">{{ file.name }}</div>
                            <div class="date">{{ file.date }}</div>
                            <div class="size">{{ file.size_display }}</div>
                            <div class="checkbox"></div>
                            <button class="delete-btn" data-file-id="{{ file.id }}">
                                <img src="{% static 'Images/delete-icon.png' %}" alt="Delete">
                            </button>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="file-item">No files found</div>
                    {% endif %}
                </div>
                
                <div class="folders">
                    <div class="title-Folders">Folders</div>
                    {% if user_data.folders %}
                        {% for folder in user_data.folders %}
                        <div class="folder-item">
                            <div class="arrow"></div>
                            <div class="name">{{ folder.name }}</div>
                            <div class="date">{{ folder.date }}</div>
                            <div class="size">{{ folder.size_display }}</div>
                            <div class="checkbox"></div>
                            <button class="delete-btn" data-folder-id="{{ folder.id }}">
                                <img src="{% static 'Images/delete-icon.png' %}" alt="Delete">
                            </button>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="folder-item">No folders found</div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="card-container">
        <div class="user-details">
            <div class="user-name">No users found</div>
        </div>
    </div>
    {% endfor %}
</div>

    <script src="{% static 'js/sidebar.js' %}"></script>
    <script src="{% static 'js/adfilespage.js' %}"></script>
</body>
</html>